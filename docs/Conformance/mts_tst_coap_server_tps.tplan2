/******************************************************************************
* Copyright (c) 2019  Fraunhofer FOKUS
* All rights reserved. This program and the accompanying materials
* are made available under the terms of the Eclipse Public License v1.0
* which accompanies this distribution, and is available at
* http://www.eclipse.org/legal/epl-v10.html
*
* Contributors:
*     Avdoot Chalke
*     Sascha Hackel
*     Marion Jost
******************************************************************************/

Package mts_tst_coap_server_tps {
	
   import all from mts_tst_coap_commons;

   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Version_001
      
      Test objective
      "The IUT shall respond on a correctly set version number."
      
      Reference 
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3",
      "RFC7252#section-4.1", "https://tools.ietf.org/html/rfc7252#section-4.1",
      "RFC7252#section-4.2 (b)", "https://tools.ietf.org/html/rfc7252#section-4.2"
      
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value CONfirmable,
               token_length indicating value 0,
               code indicating value EMPTY_METHOD,
               msg_id corresponding to MSG_ID1;
         }
         then {
            the IUT entity sends a response message containing
               version indicating value 1,
               msg_type indicating value ReSeT, 
               token_length indicating value 0,
               code indicating value EMPTY_METHOD, 
               msg_id corresponding to MSG_ID1;
            or the client entity times_out //from section 4.2 (b)
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Version_002
      
      Test objective
      "The IUT shall silently ignore an incorrectly set version number."
      
      Reference 
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3",
      "RFC7252#section-4.1", "https://tools.ietf.org/html/rfc7252#section-4.1",
      "RFC7252#section-4.2 (b)", "https://tools.ietf.org/html/rfc7252#section-4.2"
      
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 3, //reserved
               msg_type indicating value CONfirmable, 
               token_length indicating value 0,
               code indicating value EMPTY_METHOD, 
               msg_id corresponding to MSG_ID1;
         }
         then {
            the client entity times_out //2sec ACK_TIMEOUT
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Type_CON_001
      
      Test objective
      "The IUT acknowledges on a Confirmable message correctly."
      
      Reference 
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3",
      "RFC7252#section-4.2 (a)", "https://tools.ietf.org/html/rfc7252#section-4.2"
      
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               token_length indicating value 0,
               code indicating value GET_METHOD, 
               msg_id corresponding to MSG_ID1;
         }
         then {
            the IUT entity sends a response message containing
               version indicating value 1,
               msg_type indicating value ACKnowledgement, //from section 4.2 (a)
               token_length indicating value 0,
               code indicating value CONTENT, //Success (Content)
               msg_id corresponding to MSG_ID1; 
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Type_CON_002
      
      Test objective
      "The IUT rejects a Confirmable message that is carrying a response."
      
      Reference 
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3",
      "RFC7252#section-4.2 (b)", "https://tools.ietf.org/html/rfc7252#section-4.2"    
      
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               token_length indicating value 0,
               code indicating value VALID, //Valid, respnse code
               msg_id corresponding to MSG_ID1;
         }
         then {
            the IUT entity sends a response message containing
               version indicating value 1,
               msg_type indicating value ReSeT, 
               token_length indicating value 0,
               code indicating value EMPTY_METHOD, 
               msg_id corresponding to MSG_ID1;
            or the client entity times_out
         }
      }
   }
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Type_CON_003
      
      Test objective
      "The IUT rejects a Confirmable message that lacks context to process the message properly.
       The message carries a reserved class."
      
      Reference 
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3",
      "RFC7252#section-4.2 (b)", "https://tools.ietf.org/html/rfc7252#section-4.2"    
      
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               token_length indicating value 0,
               code indicating value 1.00, //reserved
               msg_id corresponding to MSG_ID1;
         }
         then {
            the IUT entity sends a response message containing
               version indicating value 1,
               msg_type indicating value ReSeT, 
               token_length indicating value 0,
               code indicating value EMPTY_METHOD, 
               msg_id corresponding to MSG_ID1;
            or the client entity times_out
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Type_NON_001
      
      Test objective
      "The IUT is acknowledging on a Non-confirmable message correctly."
      
      Reference 
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3",
      "RFC7252#section-4.3", "https://tools.ietf.org/html/rfc7252#section-4.3"
      
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value NONconfirmable, 
               token_length indicating value 0,
               code indicating value GET_METHOD, 
               msg_id corresponding to MSG_ID1;
         }
         then {
            the IUT entity sends a response message containing
               version indicating value 1,
               msg_type indicating value NONconfirmable, 
               token_length indicating value 0,
               code indicating value CONTENT,
               msg_id corresponding to MSG_ID2;
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Type_NON_002
      
      Test objective
      "The IUT is rejecting a Non-confirmable message that is Empty."
      
      Reference 
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3",
      "RFC7252#section-4.3", "https://tools.ietf.org/html/rfc7252#section-4.3"
      
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value NONconfirmable, 
               token_length indicating value 0,
               code indicating value EMPTY_METHOD, 
               msg_id corresponding to MSG_ID1;
         }
         then {
            the client entity times_out //2sec ACK_TIMEOUT 
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Type_NON_003
      
      Test objective
      "The IUT is rejecting a Non-confirmable message that is carrying a response."
      
      Reference 
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3",
      "RFC7252#section-4.3", "https://tools.ietf.org/html/rfc7252#section-4.3"
      
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value NONconfirmable, 
               token_length indicating value 0,
               code indicating value VALID,
               msg_id corresponding to MSG_ID1;
         }
         then {
            the client entity times_out //2sec ACK_TIMEOUT 
         }
      }   
   }
   
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Type_NON_004
      
      Test objective
      "The IUT is rejecting a NON-confirmable message that lacks context to process the message properly.
       The message carries a reserved class."
      
      Reference 
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3",
      "RFC7252#section-4.3", "https://tools.ietf.org/html/rfc7252#section-4.3"    
      
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               token_length indicating value 0,
               code indicating value 6.00, //reserved
               msg_id corresponding to MSG_ID1;
         }
         then {
            the client entity times_out //2sec ACK_TIMEOUT 
         }
      }
   }
   
   
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Type_ACK_001receives
      
      Test objective
      "The IUT is rejecting an Acknowledgement message that is carrying an request."
      
      Reference 
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3",
      "RFC7252#section-4.2", "https://tools.ietf.org/html/rfc7252#section-4.2"    
      
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value ACKnowledgement, 
               token_length indicating value 0,
               code indicating value POST_METHOD,
               msg_id corresponding to MSG_ID1;
         }
         then {
            the client entity times_out //2sec ACK_TIMEOUT 
         }
      }
   }
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Type_ACK_002
      
      Test objective
      "The IUT is rejecting a Acknowledgement message that carries a reserved class."
      
      Reference 
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3",
      "RFC7252#section-4.2", "https://tools.ietf.org/html/rfc7252#section-4.2"    
      
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value ACKnowledgement,
               token_length indicating value 0,
               code indicating value 7.00, //reserved
               msg_id corresponding to MSG_ID1;
         }
         then {
            the client entity times_out //2sec ACK_TIMEOUT 
         }
      }
   }
       
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Type_RST_001
      
      Test objective
      "The IUT is rejecting a Reset message that is not Empty."
      
      Reference 
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3",
      "RFC7252#section-4.2", "https://tools.ietf.org/html/rfc7252#section-4.2"    
      
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value ReSeT, 
               token_length indicating value 0,
               code indicating value POST_METHOD, //PUT request
               msg_id corresponding to MSG_ID1;
         }
         then {
            the client entity times_out //2sec ACK_TIMEOUT 
         }
      }
   }
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_TokenLength_001
      
      Test objective
      "The IUT is responding on a valid token length correctly."
      
      Reference 
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3",
      "RFC7252#section-5.3.1", "https://tools.ietf.org/html/rfc7252#section-5.3.1"
      
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               token_length indicating value 0,
               code indicating value GET_METHOD, 
               msg_id corresponding to MSG_ID1,
               token corresponding to TOKEN;
         }
         then {
            the IUT entity sends a response message containing
               version indicating value 1,
               msg_type indicating value ReSeT, 
               token_length indicating value LENGTH_TOKEN,
               code indicating value EMPTY_METHOD, 
               msg_id corresponding to MSG_ID1,
               token corresponding to TOKEN;
            or the client entity times_out
         }
      }   
   }
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_TokenLength_002
      
      Test objective
      "The IUT is not responding on a set token length that is not corresponding to the length of the actual token."
      
      Reference 
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3",
      "RFC7252#section-5.3.1", "https://tools.ietf.org/html/rfc7252#section-5.3.1"
      
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               token_length indicating value LENGTH_TOKEN_INVALID,
               code indicating value GET_METHOD, 
               msg_id corresponding to MSG_ID1;
         }
         then {
            the client entity times_out //2sec ACK_TIMEOUT 
         }
      }  
   }
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_TokenLength_003
      
      Test objective
      "The IUT is processing a message format error when receiving a reserved token length."
      
      Reference 
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3",
      "RFC7252#section-5.3.1", "https://tools.ietf.org/html/rfc7252#section-5.3.1"
      
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               token_length indicating value LENGTH_TOKEN_RESERVED,
               code indicating value GET_METHOD, 
               msg_id corresponding to MSG_ID1;
         }
         then {
            the client entity times_out //2sec ACK_TIMEOUT due to message format error
         }
      }       
   }
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Code_Content
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.05 correctly." 
      
      Reference
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3", 
      "RFC7252#section-12.1.2", "https://tools.ietf.org/html/rfc7252#section-12.1.2"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         event provideResource occurs
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               code indicating value GET_METHOD, 
               msg_id corresponding to MSG_ID1,
               uri_path corresponding to DEFAULT_RESOURCE;
         }
         then {
            the IUT entity sends the message containing 
               version indicating value 1,
               msg_type indicating value ACKnowledgement,
               token_length indicating value 0,
               code indicating value CONTENT, //Success (Content)
               msg_id corresponding to MSG_ID1,
               option corresponding to any or omitted,
               payload corresponding to DEFAULT_RESOURCE_CONTENT;   
         }
      } 
   }
   
   
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Code_MethodNotAllowed
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 4.05 correctly." 
      
      Reference
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3", 
      "RFC7252#section-12.1.2", "https://tools.ietf.org/html/rfc7252#section-12.1.2"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         event provideResource occurs with {
         	argument replaced by the resource containing
         	   name indicating value METHOD_NOT_ALLOWED_RESOURCE;
         }
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               code indicating value METHOD_NOT_ALLOWED,
               msg_id corresponding to MSG_ID1,
               uri_path corresponding to METHOD_NOT_ALLOWED_RESOURCE;
         }
         then {
            the IUT entity sends the message containing 
               version indicating value 1,
               msg_type indicating value ACKnowledgement,
               token_length indicating value 0,
               code indicating value METHOD_NOT_ALLOWED, //Client Error (Method Not Allowed)
               msg_id corresponding to MSG_ID1,
               option corresponding to any or omitted,
               payload corresponding to any or omitted;
         }
      }
   }
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Code_NotFound
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 4.04 correctly." 
      
      Reference
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3", 
      "RFC7252#section-12.1.2", "https://tools.ietf.org/html/rfc7252#section-12.1.2"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         event provideResource occurs with {
         	argument replaced by the resource containing
         	   name indicating value ANY_RESOURCE;
         }
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               code indicating value GET_METHOD,  
               msg_id corresponding to MSG_ID1,
               uri_path corresponding to ANY_RESOURCE;
         }
         then {
            the IUT entity sends the message containing 
               version indicating value 1,
               msg_type indicating value ACKnowledgement,
               token_length indicating value 0,
               code indicating value NOT_FOUND, //Client Error (Not found)
               msg_id corresponding to MSG_ID1,
               option corresponding to any or omitted,
               payload corresponding to any or omitted;
         }
      }
   }
   
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Code_Created
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.01 correctly." 
      
      Reference
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3",
      "RFC7252#section-12.1.2", "https://tools.ietf.org/html/rfc7252#section-12.1.2"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         event provideResource occurs with {
         	argument replaced by the resource containing
         	   name indicating value STORAGE_RESOURCE;
         }
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               code indicating value PUT_OR_POST, //request 
               msg_id corresponding to MSG_ID1,
               uri_path corresponding to STORAGE_RESOURCE,
               payload corresponding to any PAYLOAD;
         }
         then {
            the IUT entity sends the message containing 
               version indicating value 1,
               msg_type indicating value ACKnowledgement,
               token_length indicating value 0,
               code indicating value CREATED, //Success (Created)
               msg_id corresponding to MSG_ID1,
               option corresponding to any or omitted,
               payload corresponding to any or omitted;
         }
      }
   } 
      
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Code_Changed
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.04 correctly." 
      
      Reference
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3", 
      "RFC7252#section-12.1.2", "https://tools.ietf.org/html/rfc7252#section-12.1.2"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         event provideResource occurs with {
         	argument replaced by the resource containing
         	   name indicating value STORAGE_RESOURCE;
         }
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               code indicating value PUT_OR_POST, //request 
               msg_id corresponding to MSG_ID1,
               uri_path corresponding to STORAGE_RESOURCE,
               payload corresponding to any PAYLOAD;
         }
         then {
            the IUT entity sends the message containing 
               version indicating value 1,
               msg_type indicating value ACKnowledgement,
               token_length indicating value 0,
               code indicating value CHANGED, //Success (Changed)
               msg_id corresponding to MSG_ID1,
               option corresponding to any or omitted,
               payload corresponding to any or omitted;
         }
      }
   }
      
   Test Purpose {
      TP Id TP_CoAP_MessageFormat_Header_Code_Deleted
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.02 correctly." 
      
      Reference
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3", 
      "RFC7252#section-12.1.2", "https://tools.ietf.org/html/rfc7252#section-12.1.2"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         event provideResource occurs with {
         	argument replaced by the resource containing
         	   name indicating value DELETE_RESOURCE;
         }
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               code indicating value DELETE_METHOD, //request 
               msg_id corresponding to MSG_ID1,
               uri_path corresponding to DELETE_RESOURCE;
         }
         then {
            the IUT entity sends the message containing 
               version indicating value 1,
               msg_type indicating value ACKnowledgement,
               token_length indicating value 0,
               code indicating value DELETED, //Success (Deleted)
               msg_id corresponding to MSG_ID1,
               option corresponding to any or omitted,
               payload corresponding to any or omitted;
         }
      }
   }
   
     Test Purpose {
      TP Id TP_CoAP_MessageFormat_Payload_ZeroLengthPayloadWithMarker_001
      
      Test objective 
      "The IUT is processing a message format error whe a zero-length payload follows the payload marker (0xFF)." 
      
      Reference
      "RFC7252#section-3", "https://tools.ietf.org/html/rfc7252#section-3"
      
      PICS Selection PIC_Server

     Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               token_length indicating value 0,
               code indicating value GET_METHOD, 
               msg_id corresponding to MSG_ID1,
               option corresponding to ANY_OPTION,
               payload_marker corresponding to PAYLOAD_MARKER,
               payload corresponding to EMPTY_PAYLOAD;
         }
         then {
            the client entity times_out //2sec ACK_TIMEOUT due to message format error

         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_Server_SeparateResponse_EmptyAckMessage_001
      
      /* Summary */
      Test objective 
      "The IUT is responding with a separate empty ACK message on Confirmable request." 
      
      Reference 
      "RFC7252#section-5.2.2", "https://tools.ietf.org/html/rfc7252#section-5.2.2"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         the IUT entity must provide a resource named SEPARATE_RESOURCE
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing
	            version indicating value 1,
	            msg_type indicating value CONfirmable,
	            token_length indicating value 0,
	            code indicating value GET_METHOD,
	            msg_id indicating value MSG_ID1,
	            uri_path corresponding to SEPARATE_RESOURCE;
         }
         then {
            the IUT entity sends a response message containing
           		version indicating value 1,
               	msg_type indicating value ACKnowledgement, 
               	token_length indicating value 0,
               	code indicating value EMPTY_METHOD, 
               	msg_id corresponding to MSG_ID1;
         }
      } 
   }
   
   
   
   Test Purpose {
      TP Id TP_CoAP_Server_Separate_Response_GET_001 /* Sect. 5.8.3*/
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.05 on a GET request." 
      
      Reference 
      "RFC7252#section-5.8.4", "https://tools.ietf.org/html/rfc7252#section-5.8.4"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         the IUT entity must provide a resource named separate
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value GET_METHOD,
            uri_path corresponding to SEPARATE_RESOURCE;
         }
         then {
            
            the IUT entity first sends an empty message and
            the IUT entity sends the second message containing 
            msg_type indicating value CONfirmable,  
            code indicating value CREATED;
            and 
            the client entity sends an empty message containing 
            msg_type indicating value ACKnowledgement, 
            code indicating value EMPTY_METHOD;
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_Server_Separate_Response_POST_001 /* Sect. 5.8.2*/
      
      /* Summary */
      Test objective 
      "The IUT is responding with Confirmable and code 2.01 on a POST request." 
      
      Reference 
      "RFC7252#section-5.8.2", "https://tools.ietf.org/html/rfc7252#section-5.8.4"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         the IUT entity must provide a resource named separate
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value POST_METHOD,
            uri_path corresponding to SEPARATE_RESOURCE,
            payload indicating value 116 145 167 061 057 116 145 167 062;
         }
         then {
            
            the IUT entity first sends an empty message and
            the IUT entity sends the second message containing 
            msg_type indicating value CONfirmable,  
            code indicating value CREATED;
            and 
            the client entity sends an empty message containing 
            msg_type indicating value ACKnowledgement, 
            code indicating value EMPTY_METHOD;
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_Server_Separate_Response_POST_002 /* Sect. 5.8.2*/
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.04 on a POST request." 
      
      Reference 
      "RFC7252#section-5.8.4", "https://tools.ietf.org/html/rfc7252#section-5.8.4"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         the IUT entity must provide a resource named separate/new1/new2
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value POST_METHOD,
            uri_path corresponding to SEPARATE_RESOURCE,
            uri_path corresponding to SECOND_LVL_RESOURCE,
            uri_path corresponding to THIRD_LVL_RESOURCE,
            payload indicating value 116 145 167 061 057 116 145 167 062;
         }
         then {
            
            the IUT entity first sends an empty message and
            the IUT entity sends the second message containing 
            msg_type indicating value CONfirmable,  
            code indicating value CHANGED,
            Location_Path corresponding to SECOND_LVL_RESOURCE,
            Location_Path corresponding to THIRD_LVL_RESOURCE; /*Try to add two new resources named New1 and New2 which already exist.*/
            and 
            the client entity sends an empty message containing 
            msg_type indicating value ACKnowledgement, 
            code indicating value EMPTY_METHOD;
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_Server_Separate_Response_POST_003 /* Sect. 5.8.2*/
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.04 on a POST request." 
      
      Reference 
      "RFC7252#section-5.8.4", "https://tools.ietf.org/html/rfc7252#section-5.8.4"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         the IUT entity must provide a resource named separate/new1/new2
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value POST_METHOD,
            uri_path corresponding to SEPARATE_RESOURCE,
            uri_path corresponding to SECOND_LVL_RESOURCE,
            uri_path corresponding to NEW_RESOURCE,
            payload indicating value 116 145 167 061 057 116 145 167 062;
         }
         then {
            
            the IUT entity first sends an empty message and
            the IUT entity sends the second message containing 
            msg_type indicating value CONfirmable,  
            code indicating value CHANGED,
            Location_Path corresponding to SECOND_LVL_RESOURCE,
            Location_Path corresponding to NEW_RESOURCE; /*Change resource separate/New1/New2 to separate/New1/New1a.*/
            and 
            the client entity sends an empty message containing 
            msg_type indicating value ACKnowledgement, 
            code indicating value EMPTY_METHOD;
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_Server_Separate_Response_POST_004 /* Sect. 5.8.2*/
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 4.05 on a POST request." 
      
      Reference 
      "RFC7252#section-5.8.4", "https://tools.ietf.org/html/rfc7252#section-5.8.4"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         the IUT entity must provide a resource named separate and must not implement the POST operation
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value POST_METHOD,
            uri_path corresponding to SEPARATE_RESOURCE;
         }
         then {
            
            the IUT entity first sends an empty message and
            the IUT entity sends the second message containing 
            msg_type indicating value CONfirmable,  
            code indicating value METHOD_NOT_ALLOWED; 
            and 
            the client entity sends an empty message containing 
            msg_type indicating value ACKnowledgement, 
            code indicating value EMPTY_METHOD;
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_Server_Separate_Response_PUT_001 /* Sect. 5.8.3*/
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.01 on a PUT request." 
      
      Reference 
      "RFC7252#section-5.8.3", "https://tools.ietf.org/html/rfc7252#section-5.8.3"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         the IUT entity must provide a resource named separate
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value PUT_METHOD,
            uri_path corresponding to SEPARATE_RESOURCE,
            payload indicating value 116 145 167 061 057;
         }
         then {
            
            the IUT entity first sends an empty message and
            the IUT entity sends the second message containing 
            msg_type indicating value CONfirmable,  
            code indicating value CREATED,
            Location_Path corresponding to SECOND_LVL_RESOURCE; 
            and 
            the client entity sends an empty message containing 
            msg_type indicating value ACKnowledgement, 
            code indicating value EMPTY_METHOD;
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_Server_Separate_Response_PUT_002 /* Sect. 5.8.3*/
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.04 on a PUT request." 
      
      Reference 
      "RFC7252#section-5.8.3", "https://tools.ietf.org/html/rfc7252#section-5.8.3"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         the IUT entity must provide a resource named separate/new1
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value PUT_METHOD,
            uri_path corresponding to SEPARATE_RESOURCE,
            uri_path corresponding to SECOND_LVL_RESOURCE;
         }
         then {
            
            the IUT entity first sends an empty message and
            the IUT entity sends the second message containing 
            msg_type indicating value CONfirmable,  
            code indicating value CHANGED; /*Try to add resource New1 although it already exists */
            and 
            the client entity sends an empty message containing 
            msg_type indicating value ACKnowledgement, 
            code indicating value EMPTY_METHOD;
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_Server_Separate_Response_DELETE_001 /* Sect. 5.8.4*/
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.02 on a DELETE request." 
      
      Reference 
      "RFC7252#section-5.8.4", "https://tools.ietf.org/html/rfc7252#section-5.8.4"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         the IUT entity must provide a resource named separate
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value DELETE_METHOD,
            uri_path corresponding to SEPARATE_RESOURCE;
         }
         then {
            
            the IUT entity first sends an empty message and
            the IUT entity sends the second message containing 
            msg_type indicating value CONfirmable,  
            code indicating value DELETED,
            Location_Path corresponding to SECOND_LVL_RESOURCE; /*Delete resource Separate */
            and 
            the client entity sends an empty message containing 
            msg_type indicating value ACKnowledgement, 
            code indicating value EMPTY_METHOD;
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_Server_Separate_Response_DELETE_002 /* Sect. 5.8.4*/
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.02 on a DELETE request." 
      
      Reference 
      "RFC7252#section-5.8.4", "https://tools.ietf.org/html/rfc7252#section-5.8.4"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         the IUT entity must not provide a resource named separate
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value DELETE_METHOD,
            uri_path corresponding to SEPARATE_RESOURCE;
         }
         then {
            
            the IUT entity first sends an empty message and
            the IUT entity sends the second message containing 
            msg_type indicating value CONfirmable,  
            code indicating value DELETED,
            Location_Path corresponding to SECOND_LVL_RESOURCE; /*Get Response code 2.02 although the requested resource does not exist*/
            and 
            the client entity sends an empty message containing 
            msg_type indicating value ACKnowledgement, 
            code indicating value EMPTY_METHOD;
         } 
      }
   }  
   
      Test Purpose {
		TP Id TP_CoAP_Server_Options_OptionLength_001 /* Sect. 5.10.1. */
		
		/* Summary */
 		Test objective 
 			"The IUT processes a message format error when option length is set to 15."  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
					version indicating value 1,
					msg_type indicating value CONfirmable,
	               	token_length indicating value 0,
	               	code indicating value EMPTY_METHOD,
	               	msg_id indicating value MSG_ID1,
	               	option_length indicating value 15;
			    }
			then {
				the client entity times_out //2sec ACK_TIMEOUT
                }
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Options_OptionDelta_001 /* Sect. 5.10.1. */
		
		/* Summary */
 		Test objective 
 			"The IUT processes a message format error when option delta is set to 15 and the entire byte is not the payload marker."  
 		
 		Reference 
 			"RFC7252#section3.1", "https://tools.ietf.org/html/rfc7252#section-3.1"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named DEFAULT_RESOURCE
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
					version indicating value 1,
					msg_type indicating value CONfirmable,
	               	token_length indicating value 0,
	               	code indicating value GET_METHOD,
	               	msg_id indicating value MSG_ID1,
	               	option_delta indicating value 15;
			    }
			then {
				the client entity times_out //2sec ACK_TIMEOUT
                }
		    } 
	    }
      
      Test Purpose {
		TP Id TP_CoAP_Server_Options_UriHost_001 /* Sect. 5.10.1. */
		
		/* Summary */
 		Test objective 
 			"The Uri-Host Option specifies the Internet host of the resource
      being requested"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				host corresponding to DEFAULT_HOST, /*default eg. [2001:db8::2:1] */
				port corresponding to DEFAULT_PORT; /*default eg. 5683 */
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT,
				content indicating value coap_URI;
                }
		    } 
	    }
		    
	Test Purpose {
		TP Id TP_CoAP_Server_Options_UriHost_002 /* Sect. 5.10.1. */
		
		/* Summary */
 		Test objective 
 			"The Uri-Host Option specifies the Internet host of the resource
      being requested"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				host corresponding to DEFAULT_HOST, /*default eg. [2001:db8::2:1] */
				port corresponding to DEFAULT_PORT, /*default eg. 5683 */
				option_delta indicating value 3, /*URI-Host */
				option_value indicating value "example.net";
				
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT,
				content indicating value coap_URI;
                }
		    } 
		}
		
	Test Purpose {
		TP Id TP_CoAP_Server_Options_UriPath_001 /* Sect. 5.10.1. */
		
		/* Summary */
 		Test objective 
 			"The Uri-Path Option specifies one segment of the absolute path to
      the resource"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				host corresponding to DEFAULT_HOST, /*default eg. [2001:db8::2:1] */
				port corresponding to DEFAULT_PORT, /*default eg. 5683 */
				option_delta indicating value 3, /*URI-Host */
				option_value indicating value "example.net",
				option_delta indicating value 8, /*URI-Path */
				option_value indicating value ".well-known",
				option_delta indicating value 3, /*URI-Path */
				option_value indicating value "core";
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT,
				content indicating value coap_URI;
                }
		    } 
	    }
	    
	    Test Purpose {
      TP Id TP_CoAP_Server_Options_UriPath_002 /* Sect. 5.8.1 */
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.05 on a GET request." 
      
      Reference 
      "RFC7252#section-5.8.1", "https://tools.ietf.org/html/rfc7252#section-5.8.1"
      
      PICS Selection PIC_Server
      
      Initial conditions
      with 
      {
         the IUT entity must provide a resource named Simple_Resource/New_Resource
      }


      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value GET_METHOD,
            uri_path corresponding to DEFAULT_RESOURCE,
            uri_path corresponding to NEW_RESOURCE;
         }
         then {
            the IUT entity sends the message containing 
            msg_type indicating value ACKnowledgement, 
            code indicating value CONTENT;
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_Server_Options_UriPath_003 /* Sect. 5.8.2 */
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.04 on a POST request." 
      
      Reference 
      "RFC7252#section-5.8.2", "https://tools.ietf.org/html/rfc7252#section-5.8.2"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         the IUT entity must provide a resource named Storage_Resource/New1/New2 
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value POST_METHOD,
            uri_path corresponding to STORAGE_RESOURCE,
            uri_path corresponding to SECOND_LVL_RESOURCE,
            uri_path corresponding to NEW_RESOURCE,
            payload indicating value 116 145 167 061 057 116 145 167 062;
         }
         then {
            the IUT entity sends the message containing 
            msg_type indicating value ACKnowledgement, 
            code indicating value CHANGED,
            LocationPath corresponding to SECOND_LVL_RESOURCE,
            LocationPath corresponding to NEW_RESOURCE;
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_Server_Options_UriPath_004 /* Sect. 5.8.3*/
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.04 on a PUT request." 
      
      Reference 
      "RFC7252#section-5.8.3", "https://tools.ietf.org/html/rfc7252#section-5.8.3"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         the IUT entity must provide a resource named Storage_Resource/New1
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value PUT_METHOD,
            uri_path corresponding to STORAGE_RESOURCE,
            uri_path corresponding to SECOND_LVL_RESOURCE;
         }
         then {
            the IUT entity sends the message containing 
            msg_type indicating value ACKnowledgement, 
            code indicating value CHANGED,
            LocationPath corresponding to SECOND_LVL_RESOURCE; /*Try to add resource New1 although it already exists. */
         }
      } 
   }
	
	Test Purpose {
		TP Id TP_CoAP_Server_Options_UriQuery_001 /* Sect. 5.10.1. */
		
		/* Summary */
 		Test objective 
 			"The Uri-Query Option specifies one argument parameterizing the
      resource"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				host corresponding to DEFAULT_HOST, /*default eg. [2001:db8::2:1] */
				port corresponding to DEFAULT_PORT, /*default eg. 5683 */
				option_delta indicating value 11, /*URI-Path */
				option_value indicating value "",
				option_delta indicating value 0, /*URI-Path */
				option_value indicating value "/",
				option_delta indicating value 11, /*URI-Path */
				option_value indicating value "",
				option_delta indicating value 0, /*URI-Path */
				option_value indicating value "",
				option_delta indicating value 15, /*URI-Query */
				option_value indicating value "//",
				option_delta indicating value 0, /*URI-Query */
				option_value indicating value "?&";
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT,
				content indicating value coap_URI;
                }
		    } 
	    }

	Test Purpose {
		TP Id TP_CoAP_Server_Options_ProxyUri_001 /* Sect. 5.10.2. */
		
		/* Summary */
 		Test objective 
 			"The Proxy-Uri Option is used to make a request to a forward-proxy"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				proxy_uri corresponding to PROXY_URI;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT;        
				}
		    } 
	    }
	    
    Test Purpose {
		TP Id TP_CoAP_Server_Options_ProxyUri_002 /* Sect. 5.10.2. */
		
		/* Summary */
 		Test objective 
 			"The Proxy-Uri Option MUST take precedence over any of the Uri-Host,
   Uri-Port, Uri-Path or Uri-Query options"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				proxy_uri corresponding to PROXY_URI,
				uri_host corresponding to URI_HOST;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value METHOD_NOT_ALLOWED;             
			   }
		    } 
	    }

   Test Purpose {
		TP Id TP_CoAP_Server_Options_ContentFormat_001 /* Sect. 5.10.3. */
		
		/* Summary */
 		Test objective 
 			"The Content-Format Option indicates the representation format of the
   message payload"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				content_format_options indicating value content_formats_id,
				payload indicating value 116 145 167 061 057 116 145 167 062;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value VALID;             
			   }
		    } 
	    }

   Test Purpose {
		TP Id TP_CoAP_Server_Options_ContentFormat_002 /* Sect. 5.10.3. */
		
		/* Summary */
 		Test objective 
 			"The Content-Format Option indicates the representation format of the
   message payload, in the absence of the option, no
   default value is assumed, i.e., the representation format of any
   representation message payload is indeterminate"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				payload indicating value 116 145 167 061 057 116 145 167 062;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value NOT_ACCEPTABLE;             
			   }
		    } 
	    }

   Test Purpose {
		TP Id TP_CoAP_Server_Options_ContentAccept_001 /* Sect. 5.10.4. */
		
		/* Summary */
 		Test objective 
 			"The CoAP Accept option can be used to indicate which Content-Format
   is acceptable to the client"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				content_format_options indicating value content_formats_id,
				accept_options indicating value content_formats_id;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value VALID;             
			   }
		    } 
	    }
	    
   Test Purpose {
		TP Id TP_CoAP_Server_Options_ContentAccept_002 /* Sect. 5.10.4. */
		
		/* Summary */
 		Test objective 
 			"The CoAP Accept option can be used to indicate which Content-Format
   is acceptable to the client, If the preferred Content-
   Format cannot be returned, then a 4.06 MUST be sent
   as a response, unless another error code takes precedence for this
   response."  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				content_format_options indicating value content_formats_id,
				accept_options indicating value content_formats_id;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value NOT_ACCEPTABLE;             
			   }
		    } 
	    }
	         Test Purpose {
		TP Id TP_CoAP_Server_Options_UriHost_001 /* Sect. 5.10.1. */
		
		/* Summary */
 		Test objective 
 			"The Uri-Host Option specifies the Internet host of the resource
      being requested"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				host corresponding to DEFAULT_HOST, /*default eg. [2001:db8::2:1] */
				port corresponding to DEFAULT_PORT; /*default eg. 5683 */
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT,
				content indicating value coap_URI;
                }
		    } 
	    }
		    
	Test Purpose {
		TP Id TP_CoAP_Server_Options_UriHost_002 /* Sect. 5.10.1. */
		
		/* Summary */
 		Test objective 
 			"The Uri-Host Option specifies the Internet host of the resource
      being requested"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				host corresponding to DEFAULT_HOST, /*default eg. [2001:db8::2:1] */
				port corresponding to DEFAULT_PORT, /*default eg. 5683 */
				option_delta indicating value 3, /*URI-Host */
				option_value indicating value "example.net";
				
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT,
				content indicating value coap_URI;
                }
		    } 
		}
		
	Test Purpose {
		TP Id TP_CoAP_Server_Options_UriPath_001 /* Sect. 5.10.1. */
		
		/* Summary */
 		Test objective 
 			"The Uri-Path Option specifies one segment of the absolute path to
      the resource"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,content_format indicating value content_formats_id,
				host corresponding to DEFAULT_HOST, /*default eg. [2001:db8::2:1] */
				port corresponding to DEFAULT_PORT, /*default eg. 5683 */
				option_delta indicating value 3, /*URI-Host */
				option_value indicating value "example.net",
				option_delta indicating value 8, /*URI-Path */
				option_value indicating value ".well-known",
				option_delta indicating value 3, /*URI-Path */
				option_value indicating value "core";
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT,
				content indicating value coap_URI;
                }
		    } 
	    }
	    
	    Test Purpose {
      TP Id TP_CoAP_Server_Options_UriPath_002 /* Sect. 5.8.1 */
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.05 on a GET request." 
      
      Reference 
      "RFC7252#section-5.8.1", "https://tools.ietf.org/html/rfc7252#section-5.8.1"
      
      PICS Selection PIC_Server
      
      Initial conditions
      with 
      {
         the IUT entity must provide a resource named Simple_Resource/New_Resource
      }


      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value GET_METHOD,
            uri_path corresponding to DEFAULT_RESOURCE,
            uri_path corresponding to NEW_RESOURCE;
         }
         then {
            the IUT entity sends the message containing 
            msg_type indicating value ACKnowledgement, 
            code indicating value CONTENT;
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_Server_Options_UriPath_003 /* Sect. 5.8.2 */
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.04 on a POST request." 
      
      Reference 
      "RFC7252#section-5.8.2", "https://tools.ietf.org/html/rfc7252#section-5.8.2"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         the IUT entity must provide a resource named Storage_Resource/New1/New2 
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value POST_METHOD,
            uri_path corresponding to STORAGE_RESOURCE,
            uri_path corresponding to SECOND_LVL_RESOURCE,
            uri_path corresponding to NEW_RESOURCE,
            payload indicating value 116 145 167 061 057 116 145 167 062;
         }
         then {
            the IUT entity sends the message containing 
            msg_type indicating value ACKnowledgement, 
            code indicating value CHANGED,
            LocationPath corresponding to SECOND_LVL_RESOURCE,
            LocationPath corresponding to NEW_RESOURCE;
         }
      } 
   }
   
   Test Purpose {
      TP Id TP_CoAP_Server_Options_UriPath_004 /* Sect. 5.8.3*/
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.04 on a PUT request." 
      
      Reference 
      "RFC7252#section-5.8.3", "https://tools.ietf.org/html/rfc7252#section-5.8.3"
      
      PICS Selection PIC_Server

      Initial conditions
      with 
      {
         the IUT entity must provide a resource named Storage_Resource/New1
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value PUT_METHOD,
            uri_path corresponding to STORAGE_RESOURCE,
            uri_path corresponding to SECOND_LVL_RESOURCE;
         }
         then {
            the IUT entity sends the message containing 
            msg_type indicating value ACKnowledgement, 
            code indicating value CHANGED,
            LocationPath corresponding to SECOND_LVL_RESOURCE; /*Try to add resource New1 although it already exists. */
         }
      } 
   }
	
	Test Purpose {
		TP Id TP_CoAP_Server_Options_UriQuery_001 /* Sect. 5.10.1. */
		
		/* Summary */
 		Test objective 
 			"The Uri-Query Option specifies one argument parameterizing the
      resource"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				host corresponding to DEFAULT_HOST, /*default eg. [2001:db8::2:1] */
				port corresponding to DEFAULT_PORT, /*default eg. 5683 */
				option_delta indicating value 11, /*URI-Path */
				option_value indicating value "",
				option_delta indicating value 0, /*URI-Path */
				option_value indicating value "/",
				option_delta indicating value 11, /*URI-Path */
				option_value indicating value "",
				option_delta indicating value 0, /*URI-Path */
				option_value indicating value "",
				option_delta indicating value 15, /*URI-Query */
				option_value indicating value "//",
				option_delta indicating value 0, /*URI-Query */
				option_value indicating value "?&";
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT,
				content indicating value coap_URI;
                }
		    } 
	    }

	Test Purpose {
		TP Id TP_CoAP_Server_Options_ProxyUri_001 /* Sect. 5.10.2. */
		
		/* Summary */
 		Test objective 
 			"The Proxy-Uri Option is used to make a request to a forward-proxy"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				proxy_uri corresponding to PROXY_URI;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT;        
				}
		    } 
	    }
	    
    Test Purpose {
		TP Id TP_CoAP_Server_Options_ProxyUri_002 /* Sect. 5.10.2. */
		
		/* Summary */
 		Test objective 
 			"The Proxy-Uri Option MUST take precedence over any of the Uri-Host,
   Uri-Port, Uri-Path or Uri-Query options"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				proxy_uri corresponding to PROXY_URI,
				uri_host corresponding to URI_HOST;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value METHOD_NOT_ALLOWED;             
			   }
		    } 
	    }

   Test Purpose {
		TP Id TP_CoAP_Server_Options_ContentFormat_001 /* Sect. 5.10.3. */
		
		/* Summary */
 		Test objective 
 			"The Content-Format Option indicates the representation format of the
   message payload"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				content_format_options indicating value content_formats_id,
				payload indicating value 116 145 167 061 057 116 145 167 062;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value VALID;             
			   }
		    } 
	    }

   Test Purpose {
		TP Id TP_CoAP_Server_Options_ContentFormat_002 /* Sect. 5.10.3. */
		
		/* Summary */
 		Test objective 
 			"The Content-Format Option indicates the representation format of the
   message payload, in the absence of the option, no
   default value is assumed, i.e., the representation format of any
   representation message payload is indeterminate"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				payload indicating value 116 145 167 061 057 116 145 167 062;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value NOT_ACCEPTABLE;             
			   }
		    } 
	    }

   Test Purpose {
		TP Id TP_CoAP_Server_Options_ContentAccept_001 /* Sect. 5.10.4. */
		
		/* Summary */
 		Test objective 
 			"The CoAP Accept option can be used to indicate which Content-Format
   is acceptable to the client"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				content_format_options indicating value content_formats_id,
				accept_options indicating value content_formats_id;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value VALID;             
			   }
		    } 
	    }
	    
   Test Purpose {
		TP Id TP_CoAP_Server_Options_ContentAccept_002 /* Sect. 5.10.4. */
		
		/* Summary */
 		Test objective 
 			"The CoAP Accept option can be used to indicate which Content-Format
   is acceptable to the client, If the preferred Content-
   Format cannot be returned, then a 4.06 MUST be sent
   as a response, unless another error code takes precedence for this
   response."  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				content_format_options indicating value content_formats_id,
				accept_options indicating value content_formats_id;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value NOT_ACCEPTABLE;             
			   }
		    } 
	    }
	    
   Test Purpose {
		TP Id TP_CoAP_Server_Options_MaxAgeFresh_001 /* Sect. 5.10.5. */
		
		/* Summary */
 		Test objective 
 			"The Max-Age Option indicates the maximum time a response may be
   cached before it is considered not fresh"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD;       
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CHANGED;
			   }
		    } 
	    }
	    
	    
	    
//	Test Purpose {
//		TP Id TP_CoAP_Server_Options_MaxAge_002 /* Sect. 5.10.5. */
//		
//		/* Summary */
// 		Test objective 
// 			"The Max-Age Option indicates the maximum time a response may be
//   cached before it is considered not fresh"  
// 		
// 		Reference 
// 			"RFC7252#section5.10", 
// 			"https://tools.ietf.org/html/rfc7252#section-5.10"
// 			
// 		PICS Selection PIC_Server
//
//        Initial conditions
//        with 
//        {
//        	the IUT entity must provide a response
//        }
//        
// 		Expected behaviour
//		ensure that {
//			when {
//				the IUT entity receives the message containing 
//				msg_type indicating value CONfirmable,  
//				code indicating value GET_METHOD;       
//			    }
//			then {
//      			the IUT entity sends the message containing 
//				msg_type indicating value ACKnowledgement, 
//				code indicating value NOT_FOUND;  
//			   }
//		    } 
//	    }
	    

	Test Purpose {
		TP Id TP_CoAP_Server_Options_ETagResponse_001 /* Sect. 5.10.6.1 */
		
		/* Summary */
 		Test objective 
 			"The ETag Option in a response provides the current value (i.e., after
   the request was processed) of the entity-tag for the 'tagged
   representation'."  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD;       
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CHANGED,
				etag indicating value integer;    
			   }
		    } 
	    }
	    
	Test Purpose {
		TP Id TP_CoAP_Server_Options_EtagRequest_001 /* Sect. 5.10.6.2 */
		
		/* Summary */
 		Test objective 
 			" In a GET request, an endpoint that has one or more representations
   previously obtained from the resource, and has obtained ETag response
   options with these, can specify an instance of the ETag Option for
   one or more of these stored responses."  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD,
				etag indicating value integer;       
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value VALID; /* valid */
			   }
		    } 
	    }
	    
	Test Purpose {
		TP Id TP_CoAP_Server_Options_LocationPathLocationQuery_001 /* Sect. 5.10.7 */
		
		/* Summary */
 		Test objective 
 			"The Location-Path and Location-Query Options together indicate a
   relative URI that consists either of an absolute path, a query
   string, or both. "  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value POST_METHOD;       
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CREATED,
				location_path indicating value string,
				location_query indicating value string;
			   }
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Options_LocationPathLocationQuery_002 /* Sect. 5.10.7 */
		
		/* Summary */
 		Test objective 
 			"The Location-Path and Location-Query Options together indicate a
   relative URI that consists either of an absolute path, a query
   string, or both. "  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD,
				options indicating value 128; /* TODO: weitere Option numbers: 132,136,140, Reserved-Value */      
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION; /* Bad Option */
			   }
		    } 
	    }
	        
	Test Purpose {
		TP Id TP_CoAP_Server_Options_IfMatch_001 /* Sect. 5.10.8.1 */
		
		/* Summary */
 		Test objective 
 			" The If-Match Option MAY be used to make a request conditional on the
   current existence or value of an ETag for one or more representations
   of the target resource."  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response /*TODO: Template */
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value PUT_METHOD,
				ifMatch indicating value ETAG;    
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value VALID; /* valid */
			   }
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Options_IfMatch_002 /* Sect. 5.10.8.1 */
		
		/* Summary */
 		Test objective 
 			" The If-Match Option MAY be used to make a request conditional on the
   current existence or value of an ETag for one or more representations
   of the target resource."  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value PUT_METHOD,
				ifMatch indicating value integer representing etag; /* if-match must match with etag */       
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value NOT_FOUND; 
			   }
		    } 
	    }
	    
	        
	Test Purpose {
		TP Id TP_CoAP_Server_Options_IfNoneMatch_001 /* Sect. 5.10.8.2 */
		
		/* Summary */
 		Test objective 
 			"The If-None-Match Option MAY be used to make a request conditional on
   the nonexistence of the target resource."  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value PUT_METHOD,
				ifNoneMatch indicating value integer; /* TODO: more than one? */ 
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value VALID; /* valid */
			   }
		    } 
	    }
	    
	    	Test Purpose {
		TP Id TP_CoAP_Server_Options_IfNoneMatch_002 /* Sect. 5.10.8.2 */
		
		/* Summary */
 		Test objective 
 			"The If-None-Match Option MAY be used to make a request conditional on
   the nonexistence of the target resource."  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value PUT_METHOD,
				ifNoneMatch indicating value integer; 
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_REQUEST;
			   }
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_EmptyMessage_01 /* Sect. 4.1 (CoAP-1135)*/
		
		/* Summary */
 		Test objective 
 			"The IUT processes a message format error when data are present after Message ID field in an Empty message"  
 		
 		Reference 
 			"RFC7252#section 4.1", 
 			"https://tools.ietf.org/html/rfc7252#section-4.1"
 			
 		PICS Selection PIC_Server
        
 		Expected behaviour
		ensure that {
			when {
			 the IUT entity receives the message containing
			   version indicating value 1,
               msg_type indicating value CONfirmable, 
               token_length indicating value 0,
               code indicating value EMPTY_METHOD, 
               msg_id corresponding to MSG_ID1,
               payload indicating value ANY_PAYLOAD;
               
			    }
			then {
      			the client entity times_out //2sec ACK_TIMEOUT
			   }
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_HTTPUri_001 /* Sect. 10.1 */
		
		/* Summary */
 		Test objective 
 			"If the proxy is unable to service a request with an HTTP
                                URI, a 5.05 (Proxying Not Supported) response is returned"  
 		
 		Reference 
 			"RFC7252#section10.1", 
 			"https://tools.ietf.org/html/rfc7252#section-10.1"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1,
				proxy_uri corresponding to HTTP_URI;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value PROXYING_NOT_SUPPORTED;        
				}
		    } 
	    }
	    
	     Test Purpose {
		TP Id TP_CoAP_Server_HTTPUri_002 /* Sect. 10.1 */
		
		/* Summary */
 		Test objective 
 			"If the proxy is unable to service a request within a reasonable time frame, a 5.04 (Gateway Timeout) response is returned"  
 		
 		Reference 
 			"RFC7252#section10.1", 
 			"https://tools.ietf.org/html/rfc7252#section-10.1"
 			
 		PICS Selection PIC_Server
 		
 		/* Set Initial Condition ACK_Timeout=0 */
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1,
				proxy_uri corresponding to HTTP_URI;
				and the client entity times_out
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value GATEWAY_TIMEOUT;        
				}
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_HTTPUri_003 /* Sect. 10.1 */
		
		/* Summary */
 		Test objective 
 			"If the result can be obtained but is not understood, a 5.02 (Bad Gateway) response is returned"  
 		
 		Reference 
 			"RFC7252#section10.1", 
 			"https://tools.ietf.org/html/rfc7252#section-10.1"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1,
				proxy_uri corresponding to HTTP_URI;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_GATEWAY;        
				}
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_HTTPUri_004 /* Sect. 10.1.1 */
		
		/* Summary */
 		Test objective 
 			"The GET method requests the proxy to return a representation of the HTTP resource identified by the request URI.
             Upon success, 2.05 should be returned"  
 		
 		Reference 
 			"RFC7252#section10.1.1", 
 			"https://tools.ietf.org/html/rfc7252#section-10.1.1"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1,
				content_format_options indicating value content_formats_id,
				proxy_uri_options corresponding to HTTP_URI;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT;        
				}
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_HTTPUri_005 /* Sect. 10.1.1 */
		
		/* Summary */
 		Test objective 
 			"A client can influence the processing of a GET request to the proxy by including Accept and ETAG"  
 		
 		Reference 
 			"RFC7252#section10.1.1", 
 			"https://tools.ietf.org/html/rfc7252#section-10.1.1"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1,
				accept_options indicating value content_formats_id,
				etag_options indicating value content_formats_id,
				proxy_uri_options corresponding to HTTP_URI;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value VALID;        
				}
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_HTTPUri_006 /* Sect. 10.1.2 */
		
		/* Summary */
 		Test objective 
 			"The PUT method requests the proxy to create the HTTP resource identified by the request URI"  
 		
 		Reference 
 			"RFC7252#section10.1.2", 
 			"https://tools.ietf.org/html/rfc7252#section-10.1.2"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value PUT_METHOD,
				msg_id corresponding to MSG_ID1,
				proxy_uri corresponding to HTTP_URI;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CREATED;        
				}
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_HTTPUri_007 /* Sect. 10.1.2 */
		
		/* Summary */
 		Test objective 
 			"The PUT method requests the proxy to update the HTTP resource identified by the request URI"  
 		
 		Reference 
 			"RFC7252#section10.1.2", 
 			"https://tools.ietf.org/html/rfc7252#section-10.1.2"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value PUT_METHOD,
				msg_id corresponding to MSG_ID1,
				proxy_uri corresponding to HTTP_URI;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CHANGED;        
				}
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_HTTPUri_008 /* Sect. 10.1.3 */
		
		/* Summary */
 		Test objective 
 			"The DELETE method requests the proxy to delete the HTTP resource identified by the request URI"  
 		
 		Reference 
 			"RFC7252#section10.1.3", 
 			"https://tools.ietf.org/html/rfc7252#section-10.1.3"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value DELETE_METHOD,
				msg_id corresponding to MSG_ID1,
				proxy_uri corresponding to HTTP_URI;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value DELETED;        
				}
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_HTTPUri_009 /* Sect. 10.1.4 */
		
		/* Summary */
 		Test objective 
 			"The POST method requests the proxy to create a resource on the origin server"  
 		
 		Reference 
 			"RFC7252#section10.1.4", 
 			"https://tools.ietf.org/html/rfc7252#section-10.1.4"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value POST_METHOD,
				msg_id corresponding to MSG_ID1,
				proxy_uri corresponding to HTTP_URI;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CREATED;        
				}
		    } 
	    }

        Test Purpose {
		TP Id TP_CoAP_Server_HTTPUri_010 /* Sect. 10.1.4 */
		
		/* Summary */
 		Test objective 
 			"The POST method requests the proxy to change a resource on the origin server"  
 		
 		Reference 
 			"RFC7252#section10.1.4", 
 			"https://tools.ietf.org/html/rfc7252#section-10.1.4"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a response
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value POST_METHOD,
				msg_id corresponding to MSG_ID1,
				proxy_uri corresponding to HTTP_URI;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CHANGED;        
				}
		    } 
	    }	  
	    
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_ContentFormat_text/plain /* Sect. 12.3 */
		
		/* Summary */
 		Test objective 
 			"The IUT is responding with 2.05 code on receiving message containing text/plain of content_format_options"  
 		
 		Reference 
 			"RFC7252#section12.3", 
 			"https://tools.ietf.org/html/rfc7252#section-12.3"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a content_format_options named text_plain_content_format
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1,
				content_format_options indicating value content_format_options_id,
				text_plain_content_format indicating value text_plain_content_format_id;
			    }
			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT;        
				}
		    } 
	    }	
	    
	     Test Purpose {
		TP Id TP_CoAP_Server_ContentFormat_application/linkformat_01 /* Sect. 12.3 */
		
		/* Summary */
 		Test objective 
 			"The IUT is responding to a message containing link-format of content_format_options correctly"  
 		
 		Reference 
 			"RFC7252#section12.3", 
 			"https://tools.ietf.org/html/rfc7252#section-12.3"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a content_format_options named link_format_content_format
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1,
				content_format_options indicating value content_format_options_id,
				link_format_content_format indicating value link_format_content_format_id;
			    }
			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT;        
				}
		    } 
	    }	
	    
	     Test Purpose {
		TP Id TP_CoAP_Server_ContentFormat_application/xml_01 /* Sect. 12.3 */
		
		/* Summary */
 		Test objective 
 			"The IUT is processing to a xml_content_format message correctly"  
 		
 		Reference 
 			"RFC7252#section12.3", 
 			"https://tools.ietf.org/html/rfc7252#section-12.3"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a content_format_options named xml_content_format
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1,
				content_format_options indicating value content_format_options_id,
				xml_content_format indicating value xml_content_format_id;
			    }
			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT;        
				}
		    } 
	    }
	      
	      Test Purpose {
		TP Id TP_CoAP_Server_ContentFormat_application/octetstream /* Sect. 12.3 */
		
		/* Summary */
 		Test objective 
 			"The IUT is responding with 2.05 code on receiving message containing content_format_options named octetstream"  
 		
 		Reference 
 			"RFC7252#section12.3", 
 			"https://tools.ietf.org/html/rfc7252#section-12.3"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a content_format_options named octetstream_content_format
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1,
				content_format_options indicating value content_format_options_id,
				octetstream_content_format indicating value octetstream_content_format_id;
			    }
			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT;        
				}
		    } 
	    }
	    
	      Test Purpose {
		TP Id TP_CoAP_Server_ContentFormat_application/exi /* Sect. 12.3 */
		
		/* Summary */
 		Test objective 
 			"The IUT is processing to a message containing content_format_options named xml_content_format correctly"  
 		
 		Reference 
 			"RFC7252#section12.3", 
 			"https://tools.ietf.org/html/rfc7252#section-12.3"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a content_format_options named exi_content_format
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1,
				content_format_options indicating value content_format_options_id,
				exi_content_format indicating value exi_content_format_id;
			    }
			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT;        
				}
		    } 
	    }
	    
	    
	      Test Purpose {
		TP Id TP_CoAP_Server_ContentFormat_application/json_01 /* Sect. 12.3 */
		
		/* Summary */
 		Test objective 
 			"The IUT is processing to a content_format_options correctly"  
 		
 		Reference 
 			"RFC7252#section12.3", 
 			"https://tools.ietf.org/html/rfc7252#section-12.3"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a content_format_options named json_content_format
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1,
				content_format_options indicating value content_format_options_id,
				json_content_format indicating value json_content_format_id;
			    }
			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT;        
				}
		    } 
	    }
	    
	      Test Purpose {
		TP Id TP_CoAP_Server_ContentFormat_application/json_02 /* Sect. 5.9.2.10 */
		
		/* Summary */
 		Test objective 
 			"The IUT is responding with 4.15 code to a message containg content_format_options"  
 		
 		Reference 
 			"RFC7252#section5.9.2.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.9.2.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity doesnot provide a content_format_options named json_content_format
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1,
				content_format_options indicating value content_format_options_id,
				json_content_format indicating value json_content_format_id;
			    }
			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value UNSUPPORTED_CONTENT_FORMAT; /* Unsupported Content-Format */        
				}
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_ContentFormat_application/json_text/plain_01 /* Sect. 12.3 */
		
		/* Summary */
 		Test objective 
 			"The IUT is responding to content_format_options with 4.02 response code"  
 		
 		Reference 
 			"RFC7252#section12.3", 
 			"https://tools.ietf.org/html/rfc7252#section-12.3"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a content_format_options
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1,
				content_format_options indicating value content_format_options_id,
				json_content_format indicating value json_content_format_id,
				text_plain_content_format indicating value text_plain_content_format_id;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION;        
				}
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_ContentFormat_application/json_application/xml_01 /* Sect. 12.3 */
		
		/* Summary */
 		Test objective 
 			"The IUT is responding with Bad_Options to the message containing content_format_options "  
 		
 		Reference 
 			"RFC7252#section12.3", 
 			"https://tools.ietf.org/html/rfc7252#section-12.3"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
           the IUT entity must provide a content_format_optionscontent
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1,
				content_format_options indicating value content_formats_id,
				json indicating value json,
				content_format_options indicating value content_formats_id,
				xml indicating value xml;
			    }
			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION;        
				}
		    } 
	    }
	      
	        Test Purpose {
		TP Id TP_CoAP_Server_ContentFormat_application/json_application/xml_02 /* Sect. 12.3 */
		
		/* Summary */
 		Test objective 
 			"The IUT is processing to a content_format_options with a 4.02 code"  
 		
 		Reference 
 			"RFC7252#section12.3", 
 			"https://tools.ietf.org/html/rfc7252#section-12.3"
 			
 		PICS Selection PIC_Server

//        Initial conditions
//        with 
//        {
//        	the IUT entity must provide a content_format indicating value link_format, octet_stream
//        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1,
				content_format_options indicating value content_formats_id,
				link_format_options indicating value link_format,
				content_format_options indicating value content_formats_id,
				octet_stream indicating value octet_stream;
			    }
			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION;        
				}
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Service_Discovery_01 /* Sect. 7.1 */
		
		/* Summary */
 		Test objective 
 			"The IUT is able to provide all endpoints to the client"  
 		
 		Reference 
 			"RFC7252#section7.1", 
 			"https://tools.ietf.org/html/rfc7252#section-7.1"
 			
 		PICS Selection PIC_Server

//        Initial conditions
//        with 
//        {
//        	the IUT entity must provide a response
//        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1;
			    }
			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CONTENT;        
				}
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Critical_Options_01 /* Sect. 5.4.1 */
		
		/* Summary */
 		Test objective 
 			"A Request with unrecognized options of class critical that occur in a Confirmable request must cause the return of 4.02"  
 		
 		Reference 
 			"RFC7252#section5.4.1", 
 			"https://tools.ietf.org/html/rfc7252#section-5.4.1"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide an option named if_match
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,                         /*    Unrecognized options         */
				if_match_options indicating value if_match_options_id;  /*        if_match_options works with update request e.g. put     */
			    }
			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION;        
				}
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Critical_Options_02 /* Sect. 5.4.1 */
		
		/* Summary */
 		Test objective 
 			"A Request with unrecognized options of class critical that occur in a Confirmable request must cause the return of 4.02"  
 		
 		Reference 
 			"RFC7252#section5.4.1", 
 			"https://tools.ietf.org/html/rfc7252#section-5.4.1"
 			
 		PICS Selection PIC_Server

//        Initial conditions
//        with 
//        {
//        	the IUT entity must provide a option indicating value If-Match
//        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value PUT_METHOD,
				msg_id corresponding to MSG_ID1,
				accept_option indicating value content_format;
			    }
			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION;        
				}
		    } 
	    }
	    
	     Test Purpose {
		TP Id TP_CoAP_Server_Critical_Options_03 /* Sect. 5.4.1 */
		
		/* Summary */
 		Test objective 
 			"A Request with unrecognized options of class critical that occur in a Confirmable request must cause the return of 4.02"  
 		
 		Reference 
 			"RFC7252#section5.4.1", 
 			"https://tools.ietf.org/html/rfc7252#section-5.4.1"
 			
 		PICS Selection PIC_Server

//        Initial conditions
//        with 
//        {
//        	the IUT entity must provide a option indicating value Uri-Host
//        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value DELETE_METHOD,
				msg_id corresponding to MSG_ID1,
				host corresponding to DEFAULT_HOST, /*default eg. [2001:db8::2:1] */
				port corresponding to DEFAULT_PORT; /*default eg. 5683 */
			    }
			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION;        
				}
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Critical_Options_04 /* Sect. 5.4.1 */
		
		/* Summary */
 		Test objective 
 			"A Request with unrecognized options of class critical that occur in a Confirmable request must cause the return of 4.02"  
 		
 		Reference 
 			"RFC7252#section5.4.1", 
 			"https://tools.ietf.org/html/rfc7252#section-5.4.1"
 			
 		PICS Selection PIC_Server

    	Initial conditions
	       with 
			        {
			        	the IUT entity must provide a UriHost
			        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value 0.003,
				msg_id corresponding to MSG_ID1,
				host corresponding to DEFAULT_HOST, /*default eg. [2001:db8::2:1] */
				port corresponding to DEFAULT_PORT; /*default eg. 5683 */
			    }
			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION;        
				}
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Critical_Options_05 /* Sect. 5.4.5 */
		
		/* Summary */
 		Test objective 
 			"An option that is not repeatable MUST NOT be included more than once in a message"  
 		
 		Reference 
 			"RFC7252#section5.4.5", 
 			"https://tools.ietf.org/html/rfc7252#section-5.4.5"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a contentformat
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value GET_METHOD,
				msg_id corresponding to MSG_ID1,
				content_format_option indicating value content_formats_id,
				link_format_option indicating value link_format,
				content_format_option indicating value content_formats_options_id,
				octet_stream_content_format indicating value octet_stream_content_format_id;
			    }
			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION;        
				}
		    } 
	    }
	       
	      Test Purpose {
		TP Id TP_CoAP_Server_Critical_Options_06 /* Sect. 5.4.5 */
		
		/* Summary */
 		Test objective 
 			"The IUT responds with Bad_Option for messages containing options that are repeated more than once"  
 		
 		Reference 
 			"RFC7252#section5.4.5", 
 			"https://tools.ietf.org/html/rfc7252#section-5.4.5"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a UriHost
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				host corresponding to DEFAULT_HOST, /*default eg. [2001:db8::2:1] */
				port corresponding to DEFAULT_PORT, /*default eg. 5683 */
				host corresponding to DEFAULT_HOST, /*default eg. [2001:db8::2:1] */
				port corresponding to DEFAULT_PORT; /*default eg. 5683 */
			    }			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION;        
				}
		    } 
	    }
	    
	     Test Purpose {
		TP Id TP_CoAP_Server_Critical_Options_07 /* Sect. 5.4.5 */
		
		/* Summary */
 		Test objective 
 			"A request with multiple IfNoNeMatchOptions responds with Bad_Options code"  
 		
 		Reference 
 			"RFC7252#section5.4.5", 
 			"https://tools.ietf.org/html/rfc7252#section-5.4.5"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a IfNoNeMatchOptions
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value PUT_METHOD,
				ifNoneMatch_options indicating value integer,
				ifNoneMatch_options indicating value integer;
			    }			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION;        
				}
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Critical_Options_08 /* Sect. 5.4.5 */
		
		/* Summary */
 		Test objective 
 			"A request with multiple AcceptOptions responds with Bad_Options code"  
 		
 		Reference 
 			"RFC7252#section5.4.5", 
 			"https://tools.ietf.org/html/rfc7252#section-5.4.5"
 			
 		PICS Selection PIC_Server

//        Initial conditions
//        with 
//        {
//        	the IUT entity must provide a content-format indicating value 
//        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value GET_METHOD,
				accept_options indicating value accept_options_id,
				accept_options indicating value accept_options_id;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION;             
			   }
		    } 
	    }
	    
	   
	    Test Purpose {
		TP Id TP_CoAP_Server_Non_Confirmable_01 /* Sect. 4.3 */
		
		/* Summary */
 		Test objective 
 			"A Non-Confirmable Message send to the IUT Must not be Empty"  
 		
 		Reference 
 			"RFC7252#section 4.3", 
 			"https://tools.ietf.org/html/rfc7252#section-4.3"
 			
 		PICS Selection PIC_Server

//        Initial conditions
//        with 
//        {
//        	the IUT entity must provide a content-format indicating value 
//        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing
				version indicating value 1,
                msg_type indicating value NONconfirmable, 
                token_length indicating value 0,
                code indicating value EMPTY_METHOD; 
			    }
			then {
				the IUT entity rejects the message            
			   }
		    }
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Ack_Request_01 /* Sect. 4.3 */
		
		/* Summary */
 		Test objective 
 			"An Acknowledgement is sent as request, The IUT must reject the message"  
 		
 		Reference 
 			"RFC7252#section 4.3", 
 			"https://tools.ietf.org/html/rfc7252#section-4.3"
 			
 		PICS Selection PIC_Server

//        Initial conditions
//        with 
//        {
//        	the IUT entity must provide a content-format indicating value 
//        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing
				version indicating value 1,
                msg_type indicating value ACKnowledgement,
                token_length indicating value 0,
                code indicating value 1; 
			    }
			then {
				the IUT entity rejects the message            
			   }
		    }
	    }
	    
	  
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_NoResponse_001  /* Sect. 2.1 */
		
		/* Summary */
 		Test objective 
 			"The Server MUST reply with a reset message if it is not at all able to process a CON message"  
 		
 		Reference 
 			"RFC7252#section 4.2", 
 			"https://tools.ietf.org/html/rfc7252#section-4.2"
 			
 		PICS Selection PIC_Server

        Initial conditions
      with 
      {
         the IUT entity doesnot respond
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value GET_METHOD,
            payload indicating value 116 145 167 061 057 116 145 167 062;
            and the IUT entity doesnot provide a suitable acknowledgment response
         }
         then {
             the IUT entity sends the message containing 
		     msg_type indicating value ReSeT; 
         }
      } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Options_Elective_01
		
		/* Summary */
 		Test objective 
 			"The IUT silently ignores a request with an unrecognized, elective option."  
 		
 		Reference 
 			"RFC7252#section5.4.1", "https://tools.ietf.org/html/rfc7252#section-5.4.1"
 		
 		
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide an options named ETag
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing
					option corresponding to UNRECOGNIZED_ELECTIVE_OPTION;
			    }
			then {
      			the client entity times_out   
			   }
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Options_Critical_01
		
		/* Summary */
 		Test objective 
 			"The IUT silently ignores a request with an unrecognized, elective option."  
 		
 		Reference 
 			"RFC7252#section5.4.1", "https://tools.ietf.org/html/rfc7252#section-5.4.1"
 		
 		
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide an options named ETag
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing
					option corresponding to UNRECOGNIZED_ELECTIVE_OPTION;
			    }
			then {
      			the client entity times_out   
			   }
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Options_ETagResponse_01 /* Sect. 5.10.6.1 */
		
		/* Summary */
 		Test objective 
 			"An ETag response option can be included with any response for which there is a tagged representation."  
 		
 		Reference 
 			"RFC7252#section5.10.6.1", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10.6.1"
 		
 		
 		PICS Selection PIC_Server PIC_ETag_support	

        Initial conditions
        with 
        {
        	the IUT entity must provide an options named ETag
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD, 
				accept_options indicating value accept_options _id;    
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CHANGED,
				etag indicating value integer;    
			   }
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Options_ETagResponse_02 /* Sect. 5.10.6.1 */
		
		/* Summary */
 		Test objective 
 			"The ETag Option MUST NOT occur more than once in a response."  
 		
 		Reference 
 			"RFC7252#section5.10.6.1", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10.6.1"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide an options named ETag
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD;   
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CHANGED,
				etag1 indicating value integer;
				and another etag2 must not be present  
			   }
		    } 
	    }
	    
	     Test Purpose {
		TP Id TP_CoAP_Server_Options_ETagRequest_01 /* Sect. 5.10.6.2 */
		
		/* Summary */
 		Test objective 
 			"The IUT is responding with 2.03 valid response to the multiple ETag request"  
 		
 		Reference 
 			"RFC7252#section5.10.6.2", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10.6.2"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide an options named ETag
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD,
				etag_options_1 indicating value etag_options_id_1,
				etag_options_2 indicating value etag_options_id_2;  
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value VALID,
				etag indicating value integer; 
			   }
		    } 
	    }
	    
	      Test Purpose {
		TP Id TP_CoAP_Server_Options_ProxyUri_01 /* Sect. 5.10.2 */
		
		/* Summary */
 		Test objective 
 			"An endpoint receiving a request with a Proxy-Uri Option that is unable or unwilling to act as a forward-proxy for the request MUST cause the return of a 5.05 (Proxying Not Supported) response."  
 		
 		Reference 
 			"RFC7252#section5.10.2", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10.2"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide an options named proxy_uri_options and the IUT entity fails to respond
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD,
				proxy_uri_options indicating value proxy_uri_options_id; 				
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value PROXYING_NOT_SUPPORTED;
			   }
		    } 
	    }
	    
	     Test Purpose {
		TP Id TP_CoAP_Server_Options_Location_Path_Location_Query_01 /* Sect. 5.10.7 */
		
		/* Summary */
 		Test objective 
 			"The IUT is responding with Bad Option for a location_path_option"  
 		
 		Reference 
 			"RFC7252#section5.10.7", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10.7"
 			
 		PICS Selection PIC_Server
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD,
				location_path_options indicating value ".."; 				
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION;
			   }
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Options_Location_Path_Location_Query_02 /* Sect. 5.10.7 */
		
		/* Summary */
 		Test objective 
 			"If any reserved option numbers occurs in addition to Location-Path
              and/or Location-Query and are not supported, then a 4.02 (Bad Option)
                  error MUST be returned."  
 		
 		Reference 
 			"RFC7252#section5.10.7", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10.7"
 			
 		PICS Selection PIC_Server
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD,
				location_path_options indicating value location_path_options_id,
				location_reserved_options indicating value location_reserved_options_id; // 	 (128, 132, 136, 140) 							
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION;
			   }
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Options_Conditional_Request_01 /* Sect. 5.10.8 */
		
		/* Summary */
 		Test objective 
 			"If the if-match condition given is not fulfilled, then the server MUST NOT perform the requested method.  Instead, the server MUST respond with the 4.12 (Precondition Failed) Response
             Code."  
 		
 		Reference 
 			"RFC7252#section5.10.7", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10.7"
 			
 		PICS Selection PIC_Server
        
         Initial conditions
        with 
        {
        	the IUT entity specify if_Match conditions 
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD,
				if_match_options indicating value if_match_options_id,
				accept_options indicating value accept_options_id;
				and the client entity fails to fulfill conditions
											
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value PRECONDITION_FAILED;
			   }
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Options_Conditional_Request_02 /* Sect. 5.10.8 */
		
		/* Summary */
 		Test objective 
 			"If the if-match condition given is fulfilled, then the server MUST perform the requested method."  
 		
 		Reference 
 			"RFC7252#section5.10.7", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10.7"
 			
 		PICS Selection PIC_Server
        
         Initial conditions
        with 
        {
        	the IUT entity specify if_Match conditions 
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity sends the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD,
				if_match_options indicating value if_match_options_id,
				accept_options indicating value accept_options_id;
				and the client entity fulfill conditions										
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value VALID;
			   }
		    } 
	    } 
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Options_Conditional_Request_03 /* Sect. 5.10.8.1 */
		
		/* Summary */
 		Test objective 
 			"The IUT responds with a 2.03 code when a If-Match condition on the ETag option is fulfilled. "  
 		
 		Reference 
 			"RFC7252#section5.10.8.1", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10.8.1"
 			
 		PICS Selection PIC_Server
        
         Initial conditions
        with 
        {
        	the IUT entity specify if_Match conditions 
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity sends the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD,
				if_match_options indicating value if_match_options_id, 
				etag_options indicating value etag_options_id;
				and the client entity fulfill if_match conditions										
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value VALID;
			   }
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Options_Size1__01 /* Sect. 5.10.9 */
		
		/* Summary */
 		Test objective 
 			"The Size1 option provides size information about the resource
   representation in a request."  
 		
 		Reference 
 			"RFC7252#section5.10.9", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10.9"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide an options named Size1
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD,
				size1_options indicating value size1_options_id;       
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value REQUEST_ENTITY_TOO_LARGE,
				size_option indicating value size_max_value;  
			   }
		    } 
	    }
	    
	     Test Purpose {
		TP Id TP_CoAP_Server_NON_NoResponse_01  /* Sect. 2.1 */
		
		/* Summary */
 		Test objective 
 			"The IUT is responding with a Reset message (RST) when it is not able to process a Non-confirmable message"  
 		
 		Reference 
 			"RFC7252#section 2.1", 
 			"https://tools.ietf.org/html/rfc7252#section- 2.1"
 			
 		PICS Selection PIC_Server

        Initial conditions
      with 
      {
         the IUT entity doesnot respond
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value 1, 
            code indicating value GET_METHOD,
            payload indicating value 116 145 167 061 057 116 145 167 062;
            and the IUT entity doesnot provide a suitable acknowledgment response
         }
         then {
             the IUT entity sends the message containing 
		     msg_type indicating value ReSeT; 
         }
      } 
	    }
	    
	      Test Purpose {
		TP Id TP_CoAP_Server_CON_Piggybacked_Response_01  /* Sect. 2.2 */
		
		/* Summary */
 		Test objective 
 			"The IUT is responding with a Not Found (4.04) when it cannot provide a piggybacked response"  
 		
 		Reference 
 			"RFC7252#section 2.2", 
 			"https://tools.ietf.org/html/rfc7252#section- 2.2"
 			
 		PICS Selection PIC_Server

        Initial conditions
      with 
      {
         the IUT entity doesnot respond
      }
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value GET_METHOD,
            payload indicating value 116 145 167 061 057 116 145 167 062;
            and the IUT entity doesnot provide a suitable acknowledgment response
         }
         then {
             the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value NOT_FOUND; /* Not Found */
         }
      } 
	    }
	    
	      Test Purpose {
		TP Id TP_CoAP_Server_CON_Empty_Message_01  /* Sect. 4.1 */
		
		Test objective
      "If any data is present after the message ID field in an empty message request, then it must be processed as a message format error"
      
      Reference 
      "RFC7252#section-4.1", "https://tools.ietf.org/html/rfc7252#section-4.1"
     
      
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               token_length indicating value O,
               code indicating value EMPTY_METHOD, 
               msg_id corresponding to MSG_ID1,
               payload indicating value 116 145 167 061 057 116 145 167 062;
         }
         then {
            the client entity times_out //2sec ACK_TIMEOUT due to message format error
         }
      }       
   }
   
   
    Test Purpose {
		TP Id TP_CoAP_Server_CON_Empty_Message_02  /* Sect. 4.2 */
		
		Test objective
      "The empty message used only to elicit a reset message"
      
      Reference 
      "RFC7252#section-4.2", "https://tools.ietf.org/html/rfc7252#section-4.2"
     
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               token_length indicating value O,
               code indicating value EMPTY_METHOD, 
               msg_id corresponding to MSG_ID1;
         }
         then {
            the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement; 
         }
      }       
   }
   
   Test Purpose {
		TP Id TP_CoAP_Server_NON_EmptyMessage_01
		
		Test objective
		"The IUT rejects an empty Non-Confirmable request."
      
      Reference 
      "RFC7252#section-4.3", "https://tools.ietf.org/html/rfc7252#section-4.3"
     
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value NONconfirmable, 
               token_length indicating value O,
               code indicating value EMPTY_METHOD, 
               msg_id corresponding to MSG_ID1;
         }
         then {
            the IUT entity rejects the message 
         }
      }       
   }
   
   Test Purpose {
		TP Id TP_CoAP_Server_CON_Accept  /* Sect. 5.4.3 */
		
		Test objective
      "If the length of an option value in a request is outside the defined range, that option MUST be treated like an unrecognized option "
      
      Reference 
      "RFC7252#section-5.4.3", "https://tools.ietf.org/html/rfc7252#section-5.4.3"
     
      PICS Selection PIC_Server
      
      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a request message containing 
               version indicating value 1,
               msg_type indicating value CONfirmable, 
               token_length indicating value O,
               code indicating value GET_METHOD, //Get
               accept_options indicating value accept_options_id; /* (Oustside the defined range) */
         }
         then {
            the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION; /* Bad Option */
         }
      }       
   }
   
  Test Purpose {
		TP Id TP_CoAP_Server_Options_IfMatch_001 /* Sect. 5.4.5 */
		
		/* Summary */
 		Test objective 
 			"The IUT is responding with 2.03 response when treating multiple IfMatch_options request"  
 		
 		Reference 
 			"RFC7252#section5.4.5", 
 			"https://tools.ietf.org/html/rfc7252#section-5.4.5"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a ifMatch_options /*TODO: Template */
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD, // Get
				ifMatch_options indicating value ifMatch_options_id_1,
				ifMatch_options indicating value ifMatch_options_id_2;    
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value VALID; /* valid */
			   }
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_Options_NonRepeatable_001 /* Sect. 5.4.5 */
		
		/* Summary */
 		Test objective 
 			"An option that is not repeatable MUST NOT be included more than once in a message"  
 		
 		Reference 
 			"RFC7252#section5.4.5", 
 			"https://tools.ietf.org/html/rfc7252#section-5.4.5"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a ifNoneMatch_options 
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD, // Get
				ifNoneMatch_options indicating value ifNoneMatch_options_id1,
				ifNoneMatch_options indicating value ifNoneMatch_options_id2;    
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION; /* valid */
			   }
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_CON_Payload_01 /* Sect. 5.5 */
		
		/* Summary */
 		Test objective 
 			"If a Method or Response Code is not defined to have a payload, then a sender MUST NOT include one, and a recipient MUST ignore it"  
 		
 		Reference 
 			"RFC7252#section5.5", 
 			"https://tools.ietf.org/html/rfc7252#section-5.5"
 			
 		PICS Selection PIC_Server
        
 		Expected behaviour 
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD, // Get
				ifNoneMatch_options indicating value ifNoneMatch_options_id1,
				payload indicating value 116 145 167 061 057 116 145 167 062;  
			    }
			then {
      			the IUT entity rejects the message 
			   }
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_CON_Options_01 /* Sect. 5.9.3.2 */
		
		/* Summary */
 		Test objective 
 			"The IUT responds with 5.01 response code to an options request"  
 		
 		Reference 
 			"RFC7252#section 5.9.3.2", 
 			"https://tools.ietf.org/html/rfc7252#section-5.9.3.2"
 			
 		PICS Selection PIC_Server
        
        Initial conditions
        with 
        {
        	the IUT entity must not provide a accept_options /*TODO: Template */
        }
        
 		Expected behaviour 
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD, //Get
                accept_options indicating value accept_options_id; 
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value NOT_IMPLEMENTED; /* Not Implemented */
			   }
		    } 
	    }
	    
	    Test Purpose {
		TP Id TP_CoAP_Server_CON_Options_02 /* Sect. 5.9.2.10 */
		
		/* Summary */
 		Test objective 
 			"If an unsupported content-format is send as request, IUT corresponds with 4.15 error code"  
 		
 		Reference 
 			"RFC7252#section 5.9.2.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.9.2.10"
 			
 		PICS Selection PIC_Server
        
        Initial conditions
        with 
        {
        	the IUT entity must not provide a text_plain_content_format /*TODO: Template */
        }
        
 		Expected behaviour 
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD, //Get
                content_format_options indicating value content_format_options_id,
                text_plain_content_format indicating value text_plain_content_format_id; 
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value UNSUPPORTED_CONTENT_FORMAT; /* Unsupported Content-Format */
			   }
		    } 
	    }
   
         Test Purpose {
		TP Id TP_CoAP_Server_CON_Options_03 /* Sect. 5.9.2.9 */
		
		/* Summary */
 		Test objective 
 			"If the maximum size of a request entity exceeds, then IUT responds with 4.13 (Request Entity Too Large) error code"  
 		
 		Reference 
 			"RFC7252#section 5.9.2.9", 
 			"https://tools.ietf.org/html/rfc7252#section-5.9.2.9"
 			
 		PICS Selection PIC_Server
        
 		Expected behaviour 
		ensure that {
			when {
				the IUT entity receives the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD, //Get
				size1_options indicating value size1_options_id;           
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value REQUEST_ENTITY_TOO_LARGE,
				size_option indicating value size_max_value; /*Request Entity Too Large */
			   }
		    } 
	    }
	    
	      Test Purpose {
		TP Id TP_CoAP_Server_CON_Options_Uri_Path_01 /* Sect. 5.10.1 */
		
		/* Summary */
 		Test objective 
 			"The value of a Uri-Path Option MUST NOT be . or .."  
 		
 		Reference 
 			"RFC7252#section 5.10.1", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10.1"
 			
 		PICS Selection PIC_Server
        
 		Expected behaviour 
			ensure that {
			when {
				the IUT entity sends the message containing 
				msg_type indicating value CONfirmable,  
				code indicating value GET_METHOD,
				location_path_options indicating value ".."; 				
			    }
			then {
      			the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION;
			   }
		    } 
	    }
        
         Test Purpose {
		TP Id TP_CoAP_Server_CON_Options_Uri_Path_02 /* Sect. 5.4.1 */
		
		/* Summary */
 		Test objective 
 			"IUT responds with Bad Option to an unrecognized critical option"  
 		
 		Reference 
 			"RFC7252#section 5.4.1", 
 			"https://tools.ietf.org/html/rfc7252#section-5.4.1"
 			
 		PICS Selection PIC_Server
 		
         Initial conditions
        with 
        {
        	the IUT entity must provide an option named uri_host_options
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value PUT_METHOD, /*    Unrecognized options         */
				host corresponding to DEFAULT_HOST, 
				port corresponding to DEFAULT_PORT;  /*        Uri-Host options with 'put' will be considered unrecognized option     */
			    }
			    
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value BAD_OPTION;        
				}
		    } 
	    }
	    
	    
	    
	Test Purpose {
		TP Id TP_CoAP_Server_CON_ContentFormat /* Sect. 5.10.3. */
		
		/* Summary */
 		Test objective 
 			"IUT responds with code 2.03 for a message containing Option Content-Format"  
 		
 		Reference 
 			"RFC7252#section5.10", 
 			"https://tools.ietf.org/html/rfc7252#section-5.10"
 			
 		PICS Selection PIC_Server

        Initial conditions
        with 
        {
        	the IUT entity must provide a resource named coap_URI
        }
        
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				msg_type indicating value CONfirmable, 
				code indicating value POST_METHOD,
				content_format_options indicating value content_formats_id,
				payload indicating value 116 145 167 061 057 116 145 167 062;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value VALID;             
			   }
		    } 
	    }    
	    
	     Test Purpose {
      TP Id TP_CoAP_Server_CON_UriPath /* Sect. 5.8.2 */
      
      /* Summary */
      Test objective 
      "The IUT is responding with code 2.01 on a PUT request." 
      
      Reference 
      "RFC7252#section-5.8.2", "https://tools.ietf.org/html/rfc7252#section-5.8.2"
      
      PICS Selection PIC_Server

      Expected behaviour
      ensure that {
         when {
            the IUT entity receives a message containing 
            msg_type indicating value CONfirmable, 
            code indicating value POST_METHOD,
            uri_path corresponding to DEFAULT_RESOURCE,
            uri_path corresponding to NEW_RESOURCE;
         }
         then {
            the IUT entity sends the message containing 
            msg_type indicating value ACKnowledgement, 
            code indicating value CREATED;
         }
      } 
   }
   
    Test Purpose {
		TP Id TP_CoAP_Server_CON_HTTPUri /* Sect. 5.8.3 */
		
		/* Summary */
 		Test objective 
 			"The PUT method requests the proxy to create a resource on the origin server"  
 		
 		Reference 
 			"RFC7252#section5.8.3", 
 			"https://tools.ietf.org/html/rfc7252#section-5.8.3"
 			
 		PICS Selection PIC_Server

      
 		Expected behaviour
		ensure that {
			when {
				the IUT entity receives a message containing 
				version indicating value 1,
				msg_type indicating value CONfirmable, 
				token_length indicating value 0,
				code indicating value PUT_METHOD,
				msg_id corresponding to MSG_ID1,
				proxy_uri corresponding to HTTP_URI;
			    }
			then {
				the IUT entity sends the message containing 
				msg_type indicating value ACKnowledgement, 
				code indicating value CREATED;        
			} 
	    }	
	 }
}